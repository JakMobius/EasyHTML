!function(t){function e(t,e,i){var r=t.getLineHandle(e.line),o=e.ch-1,l=i&&i.afterCursor;null==l&&(l=/(^| )cm-fat-cursor($| )/.test(t.getWrapperElement().className));var s=!l&&o>=0&&c[r.text.charAt(o)]||c[r.text.charAt(++o)];if(!s)return null;var f=">"==s.charAt(1)?1:-1;if(i&&i.strict&&f>0!=(o==e.ch))return null;var u=t.getTokenTypeAt(a(e.line,o+1)),h=n(t,a(e.line,o+(f>0?1:0)),f,u||null,i);return null==h?null:{from:a(e.line,o),to:h&&h.pos,match:h&&h.ch==s.charAt(0),forward:f>0}}function n(t,e,n,i,r){for(var o=r&&r.maxScanLineLength||1e4,l=r&&r.maxScanLines||1e3,s=[],f=r&&r.bracketRegex?r.bracketRegex:/[(){}[\]]/,u=n>0?Math.min(e.line+l,t.lastLine()+1):Math.max(t.firstLine()-1,e.line-l),h=e.line;h!=u;h+=n){var m=t.getLine(h);if(m){var g=n>0?0:m.length-1,d=n>0?m.length:-1;if(!(m.length>o))for(h==e.line&&(g=e.ch-(n<0?1:0));g!=d;g+=n){var v=m.charAt(g);if(f.test(v)&&(void 0===i||t.getTokenTypeAt(a(h,g+1))==i))if(">"==c[v].charAt(1)==n>0)s.push(v);else{if(!s.length)return{pos:a(h,g),ch:v};s.pop()}}}}return h-n!=(n>0?t.lastLine():t.firstLine())&&null}function i(t,n,i){for(var r=t.state.matchBrackets.maxHighlightLineLength||1e3,c=[],l=t.listSelections(),s=0;s<l.length;s++){var f=l[s].empty()&&e(t,l[s].head,i);if(f&&t.getLine(f.from.line).length<=r){var u=f.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";c.push(t.markText(f.from,a(f.from.line,f.from.ch+1),{className:u})),f.to&&t.getLine(f.to.line).length<=r&&c.push(t.markText(f.to,a(f.to.line,f.to.ch+1),{className:u}))}}if(c.length){o&&t.state.focused&&t.focus();var h=function(){t.operation(function(){for(var t=0;t<c.length;t++)c[t].clear()})};if(!n)return h;setTimeout(h,800)}}function r(t){t.operation(function(){l&&(l(),l=null),l=i(t,!1,t.state.matchBrackets)})}var o=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),a=t.Pos,c={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},l=null;t.defineOption("matchBrackets",!1,function(t,e,n){n&&n!=t.Init&&(t.off("cursorActivity",r),l&&(l(),l=null)),e&&(t.state.matchBrackets="object"==typeof e?e:{},t.on("cursorActivity",r))}),t.defineExtension("matchBrackets",function(){i(this,!0)}),t.defineExtension("findMatchingBracket",function(t,n,i){return(i||"boolean"==typeof n)&&(i?(i.strict=n,n=i):n=n?{strict:!0}:null),e(this,t,n)}),t.defineExtension("scanForBracket",function(t,e,i,r){return n(this,t,e,i,r)})}(CodeMirror);
